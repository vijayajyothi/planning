!function(t){"use strict";var e=t.tablesorter,i={getRow:function(i,s,n,r){var a,o,l=i.config,h=[],c=n.closest("tr"),d=c.children();return c.hasClass(s.filter_filteredRow||"filtered")||(s.math_ignore.length&&(d=d.not("["+r+"=ignore]").not("[data-column="+s.math_ignore.join("],[data-column=")+"]")),h=d.not(n).map(function(){return a=t(this),o=a.attr(l.textAttribute),"undefined"==typeof o&&(o=this.textContent||a.text()),o=e.formatFloat(o.replace(/[^\w,. \-()]/g,""),i),isNaN(o)?0:o}).get()),h},getColumn:function(i,s,n,r,a){var o,l,h,c,d,u=[],p=i.config,f=s.filter_filteredRow||"filtered",g=parseInt(n.attr("data-column"),10),m=p.$table.children("tbody").children(),v=n.closest("tr");if("above"===r)for(c=m.index(v),o=c;o>=0;)h=m.eq(o).children().filter("[data-column="+g+"]"),d=h.filter("["+a+"^=above]").length,(!m.eq(o).hasClass(f)&&m.eq(o).not("["+a+"=ignore]").length&&o!==c||d&&o!==c)&&(d?o=0:h.length&&(l=h.attr(p.textAttribute),"undefined"==typeof l&&(l=h[0].textContent||h.text()),l=e.formatFloat(l.replace(/[^\w,. \-()]/g,""),i),u.push(isNaN(l)?0:l))),o--;else m.each(function(){h=t(this).children().filter("[data-column="+g+"]"),t(this).hasClass(f)||!h.not("["+a+"^=above],["+a+"^=col]").length||h.is(n)||(l=h.attr(p.textAttribute),"undefined"==typeof l&&(l=(h[0]?h[0].textContent:"")||h.text()),l=e.formatFloat(l.replace(/[^\w,. \-()]/g,""),i),u.push(isNaN(l)?0:l))});return u},getAll:function(i,s,n){var r,a,o,l=[],h=i.config,c=s.filter_filteredRow||"filtered",d=h.$table.children("tbody").children();return d.each(function(){t(this).hasClass(c)||t(this).children().each(function(){a=t(this),o=parseInt(a.attr("data-column"),10),!a.filter("["+n+"]").length&&t.inArray(o,s.math_ignore)<0&&(r=a.attr(h.textAttribute),"undefined"==typeof r&&(r=(a[0]?a[0].textContent:"")||a.text()),r=e.formatFloat(r.replace(/[^\w,. \-()]/g,""),i),l.push(isNaN(r)?0:r))})}),l},recalculate:function(t,s,n,r){if(s&&(!n.math_isUpdating||r)){r&&e.computeColumnIndex(s.$table.children("tbody").children());var a="data-"+(n.math_data||"math"),o=s.$tbodies.find("["+a+"]");i.mathType(t,n,o,n.math_priority,a),o=s.$table.find("."+s.cssInfoBlock+", tfoot").find("["+a+"]"),i.mathType(t,n,o,n.math_priority,a),i.mathType(t,n,s.$table.find("["+a+"^=all]"),["all"],a),n.math_isUpdating=!0,s.$table.trigger("update")}},mathType:function(s,n,r,a,o){if(r.length){var l,h,c,d,u,p=e.equations;"all"===a[0]&&(u=i.getAll(s,n,o)),t.each(a,function(e,a){r.filter("["+o+"^="+a+"]").each(function(){c=t(this),l=(c.attr(o)||"").replace(a+"-",""),d="row"===a?i.getRow(s,n,c,o):"all"===a?u:i.getColumn(s,n,c,a,o),p[l]&&(h=p[l](d),s.config.debug&&console&&console.log&&console.log(c.attr(o),d,"=",h),i.output(c,n,h,d))})})}},output:function(i,s,n,r){var a=e.formatMask(i.attr("data-"+s.math_data+"-mask")||s.math_mask,n,s.math_wrapPrefix,s.math_wrapSuffix);t.isFunction(s.math_complete)&&(a=s.math_complete(i,s,a,n,r)),a!==!1&&i.html(a)}};e.formatMask=function(t,e,i,s){if(!t||isNaN(+e))return e;var n,r,a,o,l,h,c,d,u,p,f,g,m,v,b,y,x,w,_,C="",k="";if(b=t.length,y=t.search(/[0-9\-\+#]/),x=y>0?t.substring(0,y):"",C=x,y>0&&i&&(C=/\{content\}/.test(i||"")?(i||"").replace(/\{content\}/g,x||""):(i||"")+x),_=t.split("").reverse().join(""),w=_.search(/[0-9\-\+#]/),m=b-w,m+="."===t.substring(m,m+1)?1:0,x=w>0?t.substring(m,b):"",k=x,""!==x&&s&&(k=/\{content\}/.test(s||"")?(s||"").replace(/\{content\}/g,x||""):x+(s||"")),t=t.substring(y,m),e="-"==t.charAt(0)?-e:+e,n=0>e?e=-e:0,r=t.match(/[^\d\-\+#]/g),a=r&&r[r.length-1]||".",o=r&&r[1]&&r[0]||",",t=t.split(a),e=e.toFixed(t[1]&&t[1].length),e=+e+"",h=t[1]&&t[1].lastIndexOf("0"),d=e.split("."),(!d[1]||d[1]&&d[1].length<=h)&&(e=(+e).toFixed(h+1)),u=t[0].split(o),t[0]=u.join(""),l=t[0]&&t[0].indexOf("0"),l>-1)for(;d[0].length<t[0].length-l;)d[0]="0"+d[0];else 0===+d[0]&&(d[0]="");if(e=e.split("."),e[0]=d[0],c=u[1]&&u[u.length-1].length){for(p=e[0],f="",g=p.length%c,v=p.length,m=0;v>m;m++)f+=p.charAt(m),!((m-g+1)%c)&&v-c>m&&(f+=o);e[0]=f}return e[1]=t[1]&&e[1]?a+e[1]:"",C+((n?"-":"")+e[0]+e[1])+k},e.equations={count:function(t){return t.length},sum:function(e){var i=0;return t.each(e,function(t){i+=e[t]}),i},mean:function(t){var i=e.equations.sum(t);return i/t.length},median:function(t){t.sort(function(t,e){return t-e});var e=Math.floor(t.length/2);return t.length%2?t[e]:(t[e-1]+t[e])/2},mode:function(t){if(0===t.length)return"none";var e,i,s={},n=1,r=[t[0]];for(e=0;e<t.length;e++)i=t[e],s[i]=s[i]?s[i]+1:1,s[i]>n?(r=[i],n=s[i]):s[i]===n&&(r.push(i),n=s[i]);return r.sort(function(t,e){return t-e})},max:function(t){return Math.max.apply(Math,t)},min:function(t){return Math.min.apply(Math,t)},range:function(t){var e=t.sort(function(t,e){return t-e});return e[t.length-1]-e[0]},variance:function(t,i){for(var s=e.equations.mean(t),n=0,r=t.length;r--;)n+=Math.pow(t[r]-s,2);return n/=t.length-(i?0:1)},varp:function(t){return e.equations.variance(t,!0)},vars:function(t){return e.equations.variance(t)},stdevs:function(t){var i=e.equations.variance(t);return Math.sqrt(i)},stdevp:function(t){var i=e.equations.variance(t,!0);return Math.sqrt(i)}},e.addWidget({id:"math",priority:100,options:{math_data:"math",math_ignore:[],math_mask:"#,##0.00",math_complete:null,math_priority:["row","above","col"],math_prefix:"",math_suffix:""},init:function(t,e,s,n){s.$table.bind("tablesorter-initialized update updateRows addRows updateCell filterReset filterEnd ".split(" ").join(".tsmath "),function(e){var r="tablesorter-initialized"===e.type;(!n.math_isUpdating||r)&&i.recalculate(t,s,n,r)}).bind("updateComplete.tsmath",function(){setTimeout(function(){n.math_isUpdating=!1},500)}),n.math_isUpdating=!1},remove:function(e,i,s){t(e).unbind("tablesorter-initialized update updateRows addRows updateCell filterReset filterEnd ".split(" ").join(".tsmath ")).find("[data-"+s.math_data+"]").empty()}})}(jQuery);