!function(t){"use strict";var e=t.tablesorter,i=".tscolsel",s=e.columnSelector={queryAll:"@media only all { [columns] { display: none; } }",queryBreak:"@media all and (min-width: [size]) { [columns] { display: table-cell; } }",init:function(n,r,a){var o,l;return o=t(a.columnSelector_layout),o.find("input").add(o.filter("input")).length?(r.tableId="tablesorter"+(new Date).getTime(),r.$table.addClass(r.tableId),l=r.selector={$container:t(a.columnSelector_container||"<div>")},l.$style=t("<style></style>").prop("disabled",!0).appendTo("head"),l.$breakpoints=t("<style></style>").prop("disabled",!0).appendTo("head"),l.isInitializing=!0,s.setupSelector(n,r,a),a.columnSelector_mediaquery&&s.setupBreakpoints(r,a),l.isInitializing=!1,l.$container.length&&s.updateCols(r,a),void r.$table.off("refreshColumnSelector"+i).on("refreshColumnSelector"+i,function(){var t=this.config;s.updateBreakpoints(t,t.widgetOptions),s.updateCols(t,t.widgetOptions)})):void(r.debug&&e.log("*** ERROR: Column Selector aborting, no input found in the layout! ***"))},setupSelector:function(i,n,r){var a,o=n.selector,l=o.$container,h=r.columnSelector_saveColumns&&e.storage,c=h?e.storage(i,"tablesorter-columnSelector"):[],d=h?e.storage(i,"tablesorter-columnSelector-auto"):{};o.auto=t.isEmptyObject(d)||"boolean"!==t.type(d.auto)?r.columnSelector_mediaqueryState:d.auto,o.states=[],o.$column=[],o.$wrapper=[],o.$checkbox=[],n.$table.children("thead").find("tr:first th",i).each(function(){var i=t(this),h=i.attr(r.columnSelector_priority)||1,d=i.attr("data-column"),u=e.getData(this,n.headers[d],"columnSelector");return isNaN(h)&&h.length>0||"disable"===u||r.columnSelector_columns[d]&&"disable"===r.columnSelector_columns[d]?!0:(o.states[d]=c&&"undefined"!=typeof c[d]?c[d]:"undefined"!=typeof r.columnSelector_columns[d]?r.columnSelector_columns[d]:"true"===u||!("false"===u),o.$column[d]=t(this),a=i.attr(r.columnSelector_name)||i.text(),void(l.length&&(o.$wrapper[d]=t(r.columnSelector_layout.replace(/\{name\}/g,a)).appendTo(l),o.$checkbox[d]=o.$wrapper[d].find("input").add(o.$wrapper[d].filter("input")).attr("data-column",d).prop("checked",o.states[d]).on("change",function(){o.states[d]=this.checked,s.updateCols(n,r)}).change())))})},setupBreakpoints:function(n,r){var a=n.selector;r.columnSelector_mediaquery&&(a.lastIndex=-1,r.columnSelector_breakpoints.sort(),s.updateBreakpoints(n,r),n.$table.off("updateAll"+i).on("updateAll"+i,function(){s.updateBreakpoints(n,r),s.updateCols(n,r)})),a.$container.length&&(r.columnSelector_mediaquery&&(a.$auto=t(r.columnSelector_layout.replace(/\{name\}/g,r.columnSelector_mediaqueryName)).prependTo(a.$container),a.$auto.find("input").add(a.$auto.filter("input")).attr("data-column","auto").prop("checked",a.auto).on("change",function(){a.auto=this.checked,t.each(a.$checkbox,function(t,e){e&&(e[0].disabled=a.auto,a.$wrapper[t].toggleClass("disabled",a.auto))}),r.columnSelector_mediaquery&&s.updateBreakpoints(n,r),s.updateCols(n,r),n.selector.$popup&&n.selector.$popup.find(".tablesorter-column-selector").html(a.$container.html()).find("input").each(function(){var e=t(this).attr("data-column");t(this).prop("checked","auto"===e?a.auto:a.states[e])}),r.columnSelector_saveColumns&&e.storage&&e.storage(n.$table[0],"tablesorter-columnSelector-auto",{auto:a.auto})}).change()),n.$table.off("update"+i).on("update"+i,function(){s.updateCols(n,r)}))},updateBreakpoints:function(e,i){var n,r,a,o=e.selector,l="."+e.tableId,h=[],c="";if(i.columnSelector_mediaquery&&!o.auto)return o.$breakpoints.prop("disabled",!0),void o.$style.prop("disabled",!1);for(n=0;6>n;n++)a=[],e.$headers.filter("["+i.columnSelector_priority+"="+(n+1)+"]").each(function(){r=parseInt(t(this).attr("data-column"),10)+1,a.push(l+" tr th:nth-child("+r+")"),a.push(l+" tr td:nth-child("+r+")")}),a.length&&(h=h.concat(a),c+=s.queryBreak.replace(/\[size\]/g,i.columnSelector_breakpoints[n]).replace(/\[columns\]/g,a.join(",")));o.$style&&o.$style.prop("disabled",!0),o.$breakpoints.prop("disabled",!1).html(s.queryAll.replace(/\[columns\]/g,h.join(","))+c)},updateCols:function(i,s){if(!(s.columnSelector_mediaquery&&i.selector.auto||i.selector.isInitializing)){var n,r=i.selector,a=[],o="."+i.tableId;r.$container.find("input[data-column]").filter('[data-column!="auto"]').each(function(){this.checked||(n=parseInt(t(this).attr("data-column"),10)+1,a.push(o+" tr th:nth-child("+n+")"),a.push(o+" tr td:nth-child("+n+")"))}),s.columnSelector_mediaquery&&r.$breakpoints.prop("disabled",!0),r.$style&&r.$style.prop("disabled",!1).html(a.length?a.join(",")+" { display: none; }":""),s.columnSelector_saveColumns&&e.storage&&e.storage(i.$table[0],"tablesorter-columnSelector",r.states)}},attachTo:function(e,i){e=t(e)[0];var s,n,r,a=e.config,o=t(i);o.length&&a&&(o.find(".tablesorter-column-selector").length||o.append('<span class="tablesorter-column-selector"></span>'),s=a.selector,n=a.widgetOptions,o.find(".tablesorter-column-selector").html(s.$container.html()).find("input").each(function(){var e=t(this).attr("data-column");t(this).prop("checked","auto"===e?s.auto:s.states[e])}),s.$popup=o.on("change","input",function(){r=t(this).attr("data-column"),s.$container.find('input[data-column="'+r+'"]').prop("checked",this.checked).trigger("change")}))}};e.addWidget({id:"columnSelector",priority:10,options:{columnSelector_container:null,columnSelector_columns:{},columnSelector_saveColumns:!0,columnSelector_layout:'<label><input type="checkbox">{name}</label>',columnSelector_name:"data-selector-name",columnSelector_mediaquery:!0,columnSelector_mediaqueryName:"Auto: ",columnSelector_mediaqueryState:!0,columnSelector_breakpoints:["20em","30em","40em","50em","60em","70em"],columnSelector_priority:"data-priority"},init:function(t,e,i,n){s.init(t,i,n)},remove:function(t,e){var s=e.selector;s.$container.empty(),s.$popup&&s.$popup.empty(),s.$style.remove(),s.$breakpoints.remove(),e.$table.off("updateAll"+i+" update"+i)}})}(jQuery);