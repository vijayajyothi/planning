!function(t){"use strict";var e=t.tablesorter=t.tablesorter||{},i=e.buildTable=function(s,n){var r="TABLE"===s.tagName?t(s):t("<table>").appendTo(s),a=r[0],o=n.widgetOptions=t.extend(!0,{},i.defaults,n.widgetOptions),l=o.build_processing,h=o.build_type,c=o.build_source||n.data,d=function(e){var s=t.type(e),r=e instanceof jQuery;if("function"==typeof l&&(e=l(e,o)),n.data=e,r||"string"===s){if(r||/<\s*\/tr\s*>/.test(e))return i.html(a,e,o);try{if(e=t.parseJSON(e))return i.object(a,e,o)}catch(c){}}return"array"===s||"string"===s||"array"===h||"csv"===h?i.csv(a,e,o):i.object(a,e,o)};return a.config=n,e.buildTable.hasOwnProperty(h)||""===h?void(c instanceof jQuery?d(t.trim(c.html())):c&&(c.hasOwnProperty("url")||"json"===h)?t.ajax(o.build_source).done(function(t){d(t)}).fail(function(t,i){n.debug&&e.log("aborting build table widget, failed ajax load"),r.html('<tr><td class="error">'+t.status+" "+i+"</td></tr>")}):d(c)):(n.debug&&e.log("aborting build table widget, incorrect build type"),!1)};i.defaults={build_type:"",build_source:"",build_processing:null,build_complete:"tablesorter-build-complete",build_headers:{rows:1,classes:[],text:[],widths:[]},build_footers:{rows:1,classes:[],text:[]},build_numbers:{addColumn:!1,sortable:!1},build_csvStartLine:0,build_csvSeparator:",",build_objectRowKey:"rows",build_objectCellKey:"cells",build_objectHeaderKey:"headers",build_objectFooterKey:"footers"},i.build={colgroup:function(e){var i="";return e&&e.length&&(i+="<colgroup>",t.each(e,function(t,e){i+="<col"+(e?' style="width:'+e+'"':"")+">"}),i+="</colgroup>"),i},cell:function(e,i,s,n,r){var a,o,l=r?t("<col>"):"",h=i.build_headers.classes,c=i.build_headers.widths;if(/string|number/.test(typeof e))o=t("<"+s+(h&&h[n]?' class="'+h[n]+'"':"")+">"+e+"</"+s+">"),r&&c&&c[n]&&l.width(c[n]||"");else{o=t("<"+s+">");for(a in e)e.hasOwnProperty(a)&&("text"===a||"html"===a?o[a](e[a]):r&&"width"===a?l.width(e[a]||""):o.attr(a,e[a]))}return[o,l]},header:function(e,i){var s=i.build_headers.text,n=i.build_headers.classes,r="<tr>"+(i.build_numbers.addColumn?"<th"+(i.build_numbers.sortable?"":' class="sorter-false"')+">"+i.build_numbers.addColumn+"</th>":"");return t.each(e,function(t,e){r+=/<\s*\/t(d|h)\s*>/.test(e)?e:"<th"+(n&&n[t]?' class="'+n[t]+'"':"")+">"+(s&&s[t]?s[t]:e)+"</th>"}),r+"</tr>"},rows:function(e,i,s,n,r,a){var o=a?"th":"td",l="<tr>"+(n.build_numbers.addColumn?"<"+o+">"+(a?"":r)+"</"+o+">":"");return t.each(e,function(t,e){l+=/<\s*\/t(d|h)\s*>/.test(e)?e:"<"+(a?o+(s&&s[t]?' class="'+s[t]+'"':""):o)+">"+(a&&i&&i.length&&i[t]?i[t]:e)+"</"+o+">"}),l+"</tr>"}},i.buildComplete=function(i,s){t(i).trigger(s.build_complete),e.setup(i,i.config)},i.array=function(t,e,s){return i.csv(t,e,s)},i.csv=function(e,s,n){var r,a,o,l="csv"===n.build_type||"string"==typeof s,h=t(e),c=l?s.replace("\r","").split("\n"):s,d=c.length,u=0,p=!1,f=n.build_headers.rows+(l?n.build_csvStartLine:0),g=n.build_footers.rows,m=0,v="",b=i.build.colgroup(n.build_headers.widths)+"<thead>";t.each(c,function(t,e){t>=d-g&&(p=!0),(l?t>=n.build_csvStartLine:!0)&&f>t?(a=l?i.splitCSV(e,n.build_csvSeparator):e,m=a.length,b+=i.build.header(a,n)):t>=f&&(t===f&&(b+="</thead><tbody>"),o=l?i.splitCSV(e,n.build_csvSeparator):e,p&&g>0&&(b+=(t===d-g?"</tbody><tfoot>":"")+(t===d?"</tfoot>":"")),o.length>1&&(u++,o.length!==m&&(v+="error on line "+t+": Item count ("+o.length+") does not match header count ("+m+") \n"),r=p?n.build_footers.classes:"",b+=i.build.rows(o,n.build_footers.text,r,n,u,p)))}),b+=g>0?"":"</tbody>",v?h.html(v):(h.html(b),i.buildComplete(e,n))},i.splitCSV=function(e,i){var s,n,r=t.trim(e).split(i=i||",");for(s=r.length-1;s>=0;s--)'"'===r[s].replace(/\"\s+$/,'"').charAt(r[s].length-1)?(n=r[s].replace(/^\s+\"/,'"')).length>1&&'"'===n.charAt(0)?r[s]=r[s].replace(/^\s*"|"\s*$/g,"").replace(/""/g,'"'):s?r.splice(s-1,2,[r[s-1],r[s]].join(i)):r=r.shift().split(i).concat(r):r[s].replace(/""/g,'"');return r},i.html=function(e,s,n){var r=t(e);s instanceof jQuery?r.empty().append(s):r.html(s),i.buildComplete(e,n)},i.object=function(s,n,r){var a,o,l,h,c,d,u,p=s.config,f=r.build_objectHeaderKey,g=r.build_objectRowKey,m=n.hasOwnProperty(f)&&!t.isEmptyObject(n.kh)?n.kh:n.hasOwnProperty("headers")?n.headers:!1,v=n.hasOwnProperty(g)&&!t.isEmptyObject(n.kr)?n.kr:n.hasOwnProperty("rows")?n.rows:!1;return m&&v&&0!==m.length&&0!==v.length?(h=t("<colgroup>"),c=t("<table><thead/></table>"),t.each(m,function(e,s){for(u=t("<tr>").appendTo(c.find("thead")),o=s.length,a=0;o>a;a++)l=i.build.cell(s[a],r,"th",a,0===e),l[0]&&l[0].length&&l[0].appendTo(u),0===e&&l[1]&&l[1].appendTo(h)}),h.find("col[style]").length&&c.prepend(h),d=t("<tbody>"),t.each(v,function(e,s){var n;if(l="object"===t.type(s),l&&s.newTbody){d=t("<tbody>").appendTo(c);for(n in s)s.hasOwnProperty(n)&&"newTbody"!==n&&d.attr(n,s[n])}else{if(0===e&&d.appendTo(c),u=t("<tr>").appendTo(d),l){for(n in s)s.hasOwnProperty(n)&&n!==r.build_objectCellKey&&u.attr(n,s[n]);s.hasOwnProperty(r.build_objectCellKey)&&(s=s.cells)}for(o=s.length,n=0;o>n;n++)h=i.build.cell(s[n],r,"td",n),h[0]&&h[0].length&&h[0].appendTo(u)}}),n.hasOwnProperty(r.build_objectFooterKey)&&(l=n[r.build_objectFooterKey],"clone"===l?(h=c.find("thead").html(),c.append("<tfoot>"+h+"</tfoot>")):(h=t("<tfoot>").appendTo(c),t.each(l,function(e,s){for(u=t("<tr>").appendTo(h),o=s.length,a=0;o>a;a++)d=i.build.cell(s[a],r,"th",a),d[0]&&d[0].length&&d[0].appendTo(u)}))),t(s).html(c.html()),void i.buildComplete(s,r)):(p.debug&&e.log("aborting build table widget, missing data for object build"),!1)},i.ajax=i.json=function(t,e,s){return i.object(t,e,s)}}(jQuery);