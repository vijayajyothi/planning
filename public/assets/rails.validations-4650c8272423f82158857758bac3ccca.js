(function(){var t,e,i,s,n=[].indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(e in this&&this[e]===t)return e;return-1};t=jQuery,t.fn.disableClientSideValidations=function(){return ClientSideValidations.disable(this),this},t.fn.enableClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.enablers.form(this)}),this.filter(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)}),this},t.fn.resetClientSideValidations=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return ClientSideValidations.reset(this)}),this},t.fn.validate=function(){return this.filter(ClientSideValidations.selectors.forms).each(function(){return t(this).enableClientSideValidations()}),this},t.fn.isValid=function(n){var o;return o=t(this[0]),o.is("form")?i(o,n):e(o,s(this[0].name,n))},s=function(t,e){var i,s,n;if(i=t.match(/\[(\w+_attributes)\].*\[(\w+)\]$/))for(n in e)s=e[n],n.match("\\["+i[1]+"\\].*\\[\\]\\["+i[2]+"\\]$")&&(t=t.replace(/\[[\da-z_]+\]\[(\w+)\]$/g,"[][$1]"));return e[t]||{}},i=function(e,i){var s;return e.trigger("form:validate:before.ClientSideValidations"),s=!0,e.find(ClientSideValidations.selectors.validate_inputs).each(function(){return t(this).isValid(i)||(s=!1),!0}),e.trigger(s?"form:validate:pass.ClientSideValidations":"form:validate:fail.ClientSideValidations"),e.trigger("form:validate:after.ClientSideValidations"),s},e=function(e,i){var s,n,o,a,r,l,h;return e.trigger("element:validate:before.ClientSideValidations"),l=function(){return e.trigger("element:validate:pass.ClientSideValidations").data("valid",null)},a=function(t){return e.trigger("element:validate:fail.ClientSideValidations",t).data("valid",!1),!1},s=function(){return e.trigger("element:validate:after.ClientSideValidations").data("valid")!==!1},o=function(t){var s,n,o,r,l,h,c,u;r=!0;for(n in t)if(s=t[n],i[n]){for(u=i[n],h=0,c=u.length;c>h;h++)if(l=u[h],o=s.call(t,e,l)){r=a(o);break}if(!r)break}return r},n=e.attr("name").replace(/\[([^\]]*?)\]$/,"[_destroy]"),"1"===t("input[name='"+n+"']").val()?(l(),s()):e.data("changed")===!1?s():(e.data("changed",!1),r=ClientSideValidations.validators.local,h=ClientSideValidations.validators.remote,o(r)&&o(h)&&l(),s())},void 0===window.ClientSideValidations&&(window.ClientSideValidations={}),void 0===window.ClientSideValidations.forms&&(window.ClientSideValidations.forms={}),window.ClientSideValidations.selectors={inputs:':input:not(button):not([type="submit"])[name]:visible:enabled',validate_inputs:":input:enabled:visible[data-validate]",forms:"form[data-validate]"},window.ClientSideValidations.reset=function(e){var i,s;i=t(e),ClientSideValidations.disable(e);for(s in e.ClientSideValidations.settings.validators)e.ClientSideValidations.removeError(i.find("[name='"+s+"']"));return ClientSideValidations.enablers.form(e)},window.ClientSideValidations.disable=function(e){var i;return i=t(e),i.off(".ClientSideValidations"),i.is("form")?ClientSideValidations.disable(i.find(":input")):(i.removeData("valid"),i.removeData("changed"),i.filter(":input").each(function(){return t(this).removeAttr("data-validate")}))},window.ClientSideValidations.enablers={form:function(e){var i,s,n,o;i=t(e),e.ClientSideValidations={settings:window.ClientSideValidations.forms[i.attr("id")],addError:function(t,i){return ClientSideValidations.formBuilders[e.ClientSideValidations.settings.type].add(t,e.ClientSideValidations.settings,i)},removeError:function(t){return ClientSideValidations.formBuilders[e.ClientSideValidations.settings.type].remove(t,e.ClientSideValidations.settings)}},o={"submit.ClientSideValidations":function(t){return i.isValid(e.ClientSideValidations.settings.validators)?void 0:(t.preventDefault(),t.stopImmediatePropagation())},"ajax:beforeSend.ClientSideValidations":function(t){return t.target===this?i.isValid(e.ClientSideValidations.settings.validators):void 0},"form:validate:after.ClientSideValidations":function(t){return ClientSideValidations.callbacks.form.after(i,t)},"form:validate:before.ClientSideValidations":function(t){return ClientSideValidations.callbacks.form.before(i,t)},"form:validate:fail.ClientSideValidations":function(t){return ClientSideValidations.callbacks.form.fail(i,t)},"form:validate:pass.ClientSideValidations":function(t){return ClientSideValidations.callbacks.form.pass(i,t)}};for(n in o)s=o[n],i.on(n,s);return i.find(ClientSideValidations.selectors.inputs).each(function(){return ClientSideValidations.enablers.input(this)})},input:function(e){var i,s,n,o,a,r;s=t(e),a=e.form,i=t(a),r={"focusout.ClientSideValidations":function(){return t(this).isValid(a.ClientSideValidations.settings.validators)},"change.ClientSideValidations":function(){return t(this).data("changed",!0)},"element:validate:after.ClientSideValidations":function(e){return ClientSideValidations.callbacks.element.after(t(this),e)},"element:validate:before.ClientSideValidations":function(e){return ClientSideValidations.callbacks.element.before(t(this),e)},"element:validate:fail.ClientSideValidations":function(e,i){var s;return s=t(this),ClientSideValidations.callbacks.element.fail(s,i,function(){return a.ClientSideValidations.addError(s,i)},e)},"element:validate:pass.ClientSideValidations":function(e){var i;return i=t(this),ClientSideValidations.callbacks.element.pass(i,function(){return a.ClientSideValidations.removeError(i)},e)}};for(o in r)n=r[o],s.filter(":not(:radio):not([id$=_confirmation])").each(function(){return t(this).attr("data-validate",!0)}).on(o,n);return s.filter(":checkbox").on("click.ClientSideValidations",function(){return t(this).isValid(a.ClientSideValidations.settings.validators),!0}),s.filter("[id$=_confirmation]").each(function(){var e,s,r,l;if(e=t(this),s=i.find("#"+this.id.match(/(.+)_confirmation/)[1]+":input"),s[0]){r={"focusout.ClientSideValidations":function(){return s.data("changed",!0).isValid(a.ClientSideValidations.settings.validators)},"keyup.ClientSideValidations":function(){return s.data("changed",!0).isValid(a.ClientSideValidations.settings.validators)}},l=[];for(o in r)n=r[o],l.push(t("#"+e.attr("id")).on(o,n));return l}})}},window.ClientSideValidations.validators={all:function(){return jQuery.extend({},ClientSideValidations.validators.local,ClientSideValidations.validators.remote)},local:{presence:function(t,e){return/^\s*$/.test(t.val()||"")?e.message:void 0},acceptance:function(t,e){var i;switch(t.attr("type")){case"checkbox":if(!t.prop("checked"))return e.message;break;case"text":if(t.val()!==((null!=(i=e.accept)?i.toString():void 0)||"1"))return e.message}},format:function(t,e){var i;if(i=this.presence(t,e)){if(e.allow_blank===!0)return;return i}return e["with"]&&!e["with"].test(t.val())?e.message:e.without&&e.without.test(t.val())?e.message:void 0},numericality:function(e,i){var s,n,o,a,r,l,h;if(h=jQuery.trim(e.val()),!ClientSideValidations.patterns.numericality.test(h)){if(i.allow_blank===!0&&this.presence(e,{message:i.messages.numericality}))return;return i.messages.numericality}if(h=h.replace(new RegExp("\\"+ClientSideValidations.number_format.delimiter,"g"),"").replace(new RegExp("\\"+ClientSideValidations.number_format.separator,"g"),"."),i.only_integer&&!/^[+-]?\d+$/.test(h))return i.messages.only_integer;s={greater_than:">",greater_than_or_equal_to:">=",equal_to:"==",less_than:"<",less_than_or_equal_to:"<="},r=t(e[0].form);for(n in s)if(l=s[n],null!=i[n]){if(!isNaN(parseFloat(i[n]))&&isFinite(i[n]))o=i[n];else{if(1!==r.find("[name*="+i[n]+"]").size())return;o=r.find("[name*="+i[n]+"]").val()}if(a=new Function("return "+h+" "+l+" "+o),!a())return i.messages[n]}return!i.odd||parseInt(h,10)%2?i.even&&parseInt(h,10)%2?i.messages.even:void 0:i.messages.odd},length:function(t,e){var i,s,n,o,a,r,l,h;if(h=e.js_tokenizer||"split('')",l=new Function("element","return (element.val()."+h+" || '').length")(t),i={is:"==",minimum:">=",maximum:"<="},s={},s.message=e.is?e.messages.is:e.minimum?e.messages.minimum:void 0,a=this.presence(t,s)){if(e.allow_blank===!0)return;return a}for(n in i)if(r=i[n],e[n]&&(o=new Function("return "+l+" "+r+" "+e[n]),!o()))return e.messages[n]},exclusion:function(t,e){var i,s,o,a,r;if(s=this.presence(t,e)){if(e.allow_blank===!0)return;return s}return e["in"]&&(r=t.val(),n.call(function(){var t,i,s,n;for(s=e["in"],n=[],t=0,i=s.length;i>t;t++)o=s[t],n.push(o.toString());return n}(),r)>=0)?e.message:e.range&&(i=e.range[0],a=e.range[1],t.val()>=i&&t.val()<=a)?e.message:void 0},inclusion:function(t,e){var i,s,o,a,r;if(s=this.presence(t,e)){if(e.allow_blank===!0)return;return s}if(e["in"]){if(r=t.val(),n.call(function(){var t,i,s,n;for(s=e["in"],n=[],t=0,i=s.length;i>t;t++)o=s[t],n.push(o.toString());return n}(),r)>=0)return;return e.message}if(e.range){if(i=e.range[0],a=e.range[1],t.val()>=i&&t.val()<=a)return;return e.message}},confirmation:function(t,e){return t.val()!==jQuery("#"+t.attr("id")+"_confirmation").val()?e.message:void 0},uniqueness:function(e,i){var s,n,o,a,r,l,h;return o=e.attr("name"),/_attributes\]\[\d/.test(o)&&(n=o.match(/^(.+_attributes\])\[\d+\](.+)$/),a=n[1],r=n[2],h=e.val(),a&&r&&(s=e.closest("form"),l=!0,s.find(':input[name^="'+a+'"][name$="'+r+'"]').each(function(){if(t(this).attr("name")!==o){if(t(this).val()===h)return l=!1,t(this).data("notLocallyUnique",!0);if(t(this).data("notLocallyUnique"))return t(this).removeData("notLocallyUnique").data("changed",!0)}}),!l))?i.message:void 0}},remote:{uniqueness:function(t,e){var i,s,n,o,a,r,l,h;if(n=ClientSideValidations.validators.local.presence(t,e)){if(e.allow_blank===!0)return;return n}if(i={},i.case_sensitive=!!e.case_sensitive,e.id&&(i.id=e.id),e.scope){i.scope={},h=e.scope;for(s in h)a=h[s],l=t.attr("name").replace(/\[\w+\]$/,"["+s+"]"),r=jQuery("[name='"+l+"']"),jQuery("[name='"+l+"']:checkbox").each(function(){return this.checked?r=this:void 0}),r[0]&&r.val()!==a?(i.scope[s]=r.val(),r.unbind("change."+t.id).bind("change."+t.id,function(){return t.trigger("change.ClientSideValidations"),t.trigger("focusout.ClientSideValidations")})):i.scope[s]=a}return/_attributes\]/.test(t.attr("name"))?(o=t.attr("name").match(/\[\w+_attributes\]/g).pop().match(/\[(\w+)_attributes\]/).pop(),o+=/(\[\w+\])$/.exec(t.attr("name"))[1]):o=t.attr("name"),e["class"]&&(o=e["class"]+"["+o.split("[")[1]),i[o]=t.val(),200===jQuery.ajax({url:ClientSideValidations.remote_validators_url_for("uniqueness"),data:i,async:!1,cache:!1}).status?e.message:void 0}}},window.ClientSideValidations.remote_validators_url_for=function(t){return null!=ClientSideValidations.remote_validators_prefix?"//"+window.location.host+"/"+ClientSideValidations.remote_validators_prefix+"/validators/"+t:"//"+window.location.host+"/validators/"+t},window.ClientSideValidations.disableValidators=function(){var t,e,i,s;if(void 0!==window.ClientSideValidations.disabled_validators){i=window.ClientSideValidations.validators.remote,s=[];for(e in i)t=i[e],s.push(n.call(window.ClientSideValidations.disabled_validators,e)>=0?delete window.ClientSideValidations.validators.remote[e]:void 0);return s}},window.ClientSideValidations.formBuilders={"ActionView::Helpers::FormBuilder":{add:function(e,i,s){var n,o,a,r;return n=t(e[0].form),e.data("valid")!==!1&&null==n.find("label.message[for='"+e.attr("id")+"']")[0]&&(o=jQuery(i.input_tag),r=jQuery(i.label_tag),a=n.find("label[for='"+e.attr("id")+"']:not(.message)"),e.attr("autofocus")&&e.attr("autofocus",!1),e.before(o),o.find("span#input_tag").replaceWith(e),o.find("label.message").attr("for",e.attr("id")),r.find("label.message").attr("for",e.attr("id")),r.insertAfter(a),r.find("label#label_tag").replaceWith(a)),n.find("label.message[for='"+e.attr("id")+"']").text(s)},remove:function(e,i){var s,n,o,a,r;return n=t(e[0].form),s=jQuery(i.input_tag).attr("class"),o=e.closest("."+s.replace(" ",".")),a=n.find("label[for='"+e.attr("id")+"']:not(.message)"),r=a.closest("."+s),o[0]?(o.find("#"+e.attr("id")).detach(),o.replaceWith(e),a.detach(),r.replaceWith(a)):void 0}}},window.ClientSideValidations.patterns={numericality:/^(-|\+)?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d*)?$/},window.ClientSideValidations.callbacks={element:{after:function(){},before:function(){},fail:function(t,e,i){return i()},pass:function(t,e){return e()}},form:{after:function(){},before:function(){},fail:function(){},pass:function(){}}},t(function(){return ClientSideValidations.disableValidators(),t(ClientSideValidations.selectors.forms).validate()})}).call(this);