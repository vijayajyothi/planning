!function(t){t.fn.smartWizard=function(e){var i=t.extend({},t.fn.smartWizard.defaults,e),n=arguments;return this.each(function(){function s(){var e=x.children("div");x.children("ul").addClass("anchor"),e.addClass("content"),p=t("<div>Loading</div>").addClass("loader"),g=t("<div></div>").addClass("actionBar"),m=t("<div></div>").addClass("stepContainer"),v=t("<a>"+i.labelNext+"</a>").attr("href","#").addClass("buttonNext"),y=t("<a>"+i.labelPrevious+"</a>").attr("href","#").addClass("buttonPrevious"),b=t("<a>"+i.labelFinish+"</a>").attr("href","#").addClass("buttonFinish"),i.errorSteps&&i.errorSteps.length>0&&t.each(i.errorSteps,function(t,e){u(e,!0)}),m.append(e),g.append(p),x.append(m),x.append(g),g.append(b).append(v).append(y),C=m.width(),t(v).click(function(){return h(),!1}),t(y).click(function(){return c(),!1}),t(b).click(function(){if(!t(this).hasClass("buttonDisabled"))if(t.isFunction(i.onFinish))i.onFinish.call(this,t(k));else{var e=x.parents("form");e&&e.length&&e.submit()}return!1}),t(k).bind("click",function(){if(k.index(this)==w)return!1;var t=k.index(this);return k.eq(t).attr("isDone")-0==1&&r(t),!1}),i.keyNavigation&&t(document).keyup(function(t){39==t.which?h():37==t.which&&c()}),o(),r(w)}function o(){i.enableAllSteps?(t(k,x).removeClass("selected").removeClass("disabled").addClass("done"),t(k,x).attr("isDone",1)):(t(k,x).removeClass("selected").removeClass("done").addClass("disabled"),t(k,x).attr("isDone",0)),t(k,x).each(function(e){t(t(this).attr("href"),x).hide(),t(this).attr("rel",e+1)})}function r(e){var n=k.eq(e),s=i.contentURL,o=n.data("hasContent");stepNum=e+1,s&&s.length>0?i.contentCache&&o?a(e):t.ajax({url:s,type:"POST",data:{step_number:stepNum},dataType:"text",beforeSend:function(){p.show()},error:function(){p.hide()},success:function(i){p.hide(),i&&i.length>0&&(n.data("hasContent",!0),t(t(n,x).attr("href"),x).html(i),a(e))}}):a(e)}function a(e){var n=k.eq(e),s=k.eq(w);if(e!=w&&t.isFunction(i.onLeaveStep)&&!i.onLeaveStep.call(this,t(s)))return!1;if(m.height(t(t(n,x).attr("href"),x).outerHeight()),"slide"==i.transitionEffect)t(t(s,x).attr("href"),x).slideUp("fast",function(){t(t(n,x).attr("href"),x).slideDown("fast"),w=e,l(s,n)});else if("fade"==i.transitionEffect)t(t(s,x).attr("href"),x).fadeOut("fast",function(){t(t(n,x).attr("href"),x).fadeIn("fast"),w=e,l(s,n)});else if("slideleft"==i.transitionEffect){var o=0;e>w?(nextElmLeft1=C+10,nextElmLeft2=0,o=0-t(t(s,x).attr("href"),x).outerWidth()):(nextElmLeft1=0-t(t(n,x).attr("href"),x).outerWidth()+20,nextElmLeft2=0,o=10+t(t(s,x).attr("href"),x).outerWidth()),e==w?(nextElmLeft1=t(t(n,x).attr("href"),x).outerWidth()+20,nextElmLeft2=0,o=0-t(t(s,x).attr("href"),x).outerWidth()):t(t(s,x).attr("href"),x).animate({left:o},"fast",function(){t(t(s,x).attr("href"),x).hide()}),t(t(n,x).attr("href"),x).css("left",nextElmLeft1),t(t(n,x).attr("href"),x).show(),t(t(n,x).attr("href"),x).animate({left:nextElmLeft2},"fast",function(){w=e,l(s,n)})}else t(t(s,x).attr("href"),x).hide(),t(t(n,x).attr("href"),x).show(),w=e,l(s,n);return!0}function l(e,n){return t(e,x).removeClass("selected"),t(e,x).addClass("done"),t(n,x).removeClass("disabled"),t(n,x).removeClass("done"),t(n,x).addClass("selected"),t(n,x).attr("isDone",1),i.cycleSteps||(0>=w?t(y).addClass("buttonDisabled"):t(y).removeClass("buttonDisabled"),k.length-1<=w?t(v).addClass("buttonDisabled"):t(v).removeClass("buttonDisabled")),!k.hasClass("disabled")||i.enableFinishButton?t(b).removeClass("buttonDisabled"):t(b).addClass("buttonDisabled"),t.isFunction(i.onShowStep)&&!i.onShowStep.call(this,t(n))?!1:void 0}function h(){var t=w+1;if(k.length<=t){if(!i.cycleSteps)return!1;t=0}r(t)}function c(){var t=w-1;if(0>t){if(!i.cycleSteps)return!1;t=k.length-1}r(t)}function d(e){t(".content",f).html(e),f.show()}function u(e,i){i?t(k.eq(e-1),x).addClass("error"):t(k.eq(e-1),x).removeClass("error")}var p,f,g,m,v,y,b,x=t(this),w=i.selected,k=t("ul > li > a",x),C=0;if(g=t(".actionBar",x),0==g.length&&(g=t("<div></div>").addClass("actionBar")),f=t(".msgBox",x),0==f.length&&(f=t('<div class="msgBox"><div class="content"></div><a href="#" class="close">X</a></div>'),g.append(f)),t(".close",f).click(function(){return f.fadeOut("normal"),!1}),e&&"init"!==e&&"object"!=typeof e){if("showMessage"===e){var _=Array.prototype.slice.call(n,1);return d(_[0]),!0}if("setError"===e)return _=Array.prototype.slice.call(n,1),u(_[0].stepnum,_[0].iserror),!0;t.error("Method "+e+" does not exist")}else s()})},t.fn.smartWizard.defaults={selected:0,keyNavigation:!0,enableAllSteps:!1,transitionEffect:"fade",contentURL:null,contentCache:!0,cycleSteps:!1,enableFinishButton:!1,errorSteps:[],labelNext:"Next",labelPrevious:"Previous",labelFinish:"Submit",onLeaveStep:null,onShowStep:null,onFinish:null}}(jQuery);